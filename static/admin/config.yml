backend:
  name: git-gateway
  branch: main
  # publish_mode: editorial_workflow   # ‚Üê optional: enables Draft/Review/Publish in Decap

media_folder: "static/img"
public_folder: "/img"

slug:
  encoding: "ascii"
  clean_accents: true
  sanitize_replacement: "-"

collections:
  # -------------------------
  # Films
  # -------------------------
  - name: "films"
    label: "Films"
    folder: "content/films"
    create: true
    extension: "md"
    format: "frontmatter"

    # Use the custom filename field as the identifier (and therefore for {{slug}})
    identifier_field: "file_name"
    slug: "{{year}}-{{slug}}"
    summary: "{{film_title}} ({{year}})"

    fields:
      - label: "Date"
        name: "date"
        widget: "datetime"
        format: "YYYY-MM-DDTHH:mm:ssZ"
        picker_utc: false
        default: "{{now}}"

      # Draft toggle
      - { label: "Draft", name: "draft", widget: "boolean", default: true, hint: "Uncheck to publish." }

      # NEW: explicit filename control (what becomes the slug base)
      - label: "File name (slug base)"
        name: "file_name"
        widget: "string"
        required: true
        hint: "Lowercase letters, numbers, hyphens/underscores. No spaces. Example: exploding-girl"
        pattern:
          - "^[a-z0-9]+([_-][a-z0-9]+)*$"
          - "Use lowercase letters, numbers, and - or _. No spaces."

      # Visible fields for the page
      - { label: "Film title", name: "film_title", widget: "string", required: true }
      - { label: "Original title", name: "film_title_org", widget: "string", required: false }
      - { label: "Country", name: "country", widget: "string", required: true }
      - { label: "Year", name: "year", widget: "string", required: true }
      - { label: "Minutes", name: "minutes", widget: "string", required: true }
      - { label: "Description", name: "description", widget: "text", required: false }
      - { label: "Text author", name: "text_author", widget: "string", required: false }
      - { label: "Stream duration (label)", name: "stream_duration", widget: "string", required: true }
      - { label: "Director", name: "Director", widget: "string", required: false }
      - { label: "Production", name: "Production", widget: "string", required: false }
      - { label: "Screenwriter", name: "Screenwriter", widget: "string", required: false }
      - { label: "Editing", name: "Editing", widget: "string", required: false }
      - { label: "Cinematography", name: "Cinematography", widget: "string", required: false }
      - { label: "Sound", name: "Sound", widget: "string", required: false }
      - { label: "Music", name: "Music", widget: "string", required: false }
      - { label: "Voiceover", name: "Voiceover", widget: "string", required: false }
      - { label: "Lead actors (comma-separated)", name: "LeadActors", widget: "string", required: false }
      - { label: "Animator(s) (comma-separated)", name: "animator", widget: "string", required: false }

      - { label: "Thumbnail (poster)", name: "thumbnail", widget: "image", allow_multiple: false, required: true }
      - { label: "Feature image", name: "feature_image", widget: "image", allow_multiple: false, required: true }

      - { label: "Show watch button", name: "show_watch_button", widget: "boolean", default: true }
      - { label: "Cloudflare video ID", name: "video_id", widget: "string", required: false }
      - { label: "Cloudflare HLS link", name: "HLS", widget: "string", required: false }
      - { label: "Signed token (auto)", name: "signed_token", widget: "string", required: false }

      - label: "Hero Video ID (front page)"
        name: "hero_video_id"
        widget: "string"
        required: false
        hint: "Cloudflare Stream video ID used for the homepage hero."
        pattern:
          - "^[a-f0-9]{32}$"
          - "Must be a 32-character lowercase hex Cloudflare Stream ID (e.g. 7a587a49c9cf21aae8842ed12565765a)."

      - { label: "Body", name: "body", widget: "markdown", required: false }

  # -------------------------
  # Posters
  # -------------------------
  - name: "posters"
    label: "Posters"
    folder: "content/posters"
    create: true
    identifier_field: "title"
    slug: "{{year}}-{{slug}}"
    extension: "md"
    format: "frontmatter"
    fields:
      - { label: "Title", name: "title", widget: "string" }
      - { label: "Author", name: "author", widget: "string", required: false }
      - { label: "Year", name: "year", widget: "string", required: false }
      - { label: "Thumbnail", name: "thumbnail", widget: "image", required: false }
      - label: "Publish Date"
        name: "date"
        widget: "datetime"
        format: "YYYY-MM-DDTHH:mm:ssZ"
        picker_utc: false
        default: "{{now}}"
        required: false

  # -------------------------
  # Pages (About)
  # -------------------------
  - name: "pages"
    label: "Pages"
    files:
      - name: "about"
        label: "About"
        file: "content/about/_index.md"
        format: "frontmatter"
        fields:
          - { label: "Title", name: "title", widget: "string" }
          - { label: "Header Image", name: "header_image", widget: "image", required: false }
          - { label: "Body", name: "body", widget: "markdown", required: false }

  # -------------------------
  # Site Configuration (edits hugo.toml)
  # -------------------------
  - name: "config"
    label: "Site Configuration"
    delete: false
    editor:
      preview: false
    files:
      - label: "General Settings"
        name: "site"
        file: "hugo.toml"
        format: "toml"
        fields:
          - { label: "Base URL", name: "baseURL", widget: "string" }
          - { label: "Language Code", name: "languageCode", widget: "string" }
          - { label: "Title", name: "title", widget: "string" }
          - { label: "Theme", name: "theme", widget: "string" }

          - label: "Params"
            name: "params"
            widget: "object"
            fields:
              - { label: "Site Description", name: "description", widget: "text" }

              - label: "SEO"
                name: "seo"
                widget: "object"
                fields:
                  - { label: "Site Name (og:site_name)", name: "site_name", widget: "string", required: false }
                  - { label: "Default OG Image", name: "defaultImage", widget: "image", media_folder: "static/img", public_folder: "/img", required: false }
                  - { label: "og:locale", name: "locale", widget: "string", default: "bg_BG" }
                  - label: "Twitter Card"
                    name: "twitterCard"
                    widget: "select"
                    options: ["summary", "summary_large_image"]
                    default: "summary_large_image"
                    required: false
                  - { label: "Twitter @site", name: "twitterSite", widget: "string", required: false }
                  - { label: "Robots (site-wide)", name: "robots", widget: "string", required: false }

              - label: "Organization"
                name: "org"
                widget: "object"
                fields:
                  - { label: "Name", name: "name", widget: "string" }
                  - { label: "URL", name: "url", widget: "string" }
                  - { label: "Logo", name: "logo", widget: "image", media_folder: "static/img", public_folder: "/img" }
                  - label: "Same As (profiles)"
                    name: "sameAs"
                    widget: "list"
                    field: { label: "Profile URL", name: "item", widget: "string" }

              - label: "Partners (ticker)"
                name: "partners"
                widget: "list"
                allow_add: true
                summary: "{{fields.alt}}"
                fields:
                  - { label: "URL", name: "url", widget: "string", required: false }
                  - { label: "Image", name: "img", widget: "image", media_folder: "static/img", public_folder: "/img" }
                  - { label: "Alt Text", name: "alt", widget: "string" }
